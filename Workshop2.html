<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Workshop 2 – CH4004 R programming</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Workshop3_introduction.html" rel="next">
<link href="./Workshop1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-29a19b5acbeac218a8c860e48340d4df.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./CH4004-R-logo2.png" alt="" class="navbar-logo light-content">
    <img src="./CH4004-R-logo2.png" alt="" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">CH4004 R programming</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Workshop1.html" aria-current="page"> 
<span class="menu-text">Workshop 1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Workshop2.html"> 
<span class="menu-text">Workshop 2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Workshop3_introduction.html"> 
<span class="menu-text">Workshop 3</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Workshop2.html">Workshop 2</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Workshop1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Workshop2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Workshop 2</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Workshop 3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Workshop3_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Workshop 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Workshop3_ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loading Data and Making Your First Plot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Workshop3_plot-types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploring Plot Types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Workshop3_ggplot-themes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Labels, Themes and Faceting</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#welcome-to-workshop-2-cleaning-and-wrangling-your-chemistry-data" id="toc-welcome-to-workshop-2-cleaning-and-wrangling-your-chemistry-data" class="nav-link active" data-scroll-target="#welcome-to-workshop-2-cleaning-and-wrangling-your-chemistry-data">Welcome to Workshop 2: Cleaning and Wrangling Your Chemistry Data</a>
  <ul class="collapse">
  <li><a href="#working-with-r-studio" id="toc-working-with-r-studio" class="nav-link" data-scroll-target="#working-with-r-studio">Working with R Studio</a></li>
  <li><a href="#saving-work" id="toc-saving-work" class="nav-link" data-scroll-target="#saving-work">Saving work</a></li>
  <li><a href="#datasets-used-in-this-worksheet" id="toc-datasets-used-in-this-worksheet" class="nav-link" data-scroll-target="#datasets-used-in-this-worksheet">Datasets used in this worksheet</a></li>
  <li><a href="#how-to-use-code-chunks-in-this-worksheet" id="toc-how-to-use-code-chunks-in-this-worksheet" class="nav-link" data-scroll-target="#how-to-use-code-chunks-in-this-worksheet">How to use Code Chunks in this Worksheet?</a></li>
  <li><a href="#data-source-acknowledgement" id="toc-data-source-acknowledgement" class="nav-link" data-scroll-target="#data-source-acknowledgement">Data Source Acknowledgement</a></li>
  </ul></li>
  <li><a href="#understanding-r-packages" id="toc-understanding-r-packages" class="nav-link" data-scroll-target="#understanding-r-packages">Understanding R packages</a>
  <ul class="collapse">
  <li><a href="#how-package-installation-works" id="toc-how-package-installation-works" class="nav-link" data-scroll-target="#how-package-installation-works">How package installation works</a></li>
  <li><a href="#exercise-loading-packages" id="toc-exercise-loading-packages" class="nav-link" data-scroll-target="#exercise-loading-packages">Exercise: Loading packages</a></li>
  <li><a href="#why-cleaning-your-data-matters-in-chemistry" id="toc-why-cleaning-your-data-matters-in-chemistry" class="nav-link" data-scroll-target="#why-cleaning-your-data-matters-in-chemistry">Why Cleaning Your Data Matters in Chemistry</a></li>
  <li><a href="#common-data-problems-in-chemistry" id="toc-common-data-problems-in-chemistry" class="nav-link" data-scroll-target="#common-data-problems-in-chemistry">Common data problems in chemistry:</a></li>
  </ul></li>
  <li><a href="#importing-the-esol-dataset" id="toc-importing-the-esol-dataset" class="nav-link" data-scroll-target="#importing-the-esol-dataset">Importing the ESOL Dataset</a>
  <ul class="collapse">
  <li><a href="#exercise-import-the-esol-dataset" id="toc-exercise-import-the-esol-dataset" class="nav-link" data-scroll-target="#exercise-import-the-esol-dataset">Exercise: Import the ESOL dataset</a></li>
  </ul></li>
  <li><a href="#exploring-the-esol-dataset" id="toc-exploring-the-esol-dataset" class="nav-link" data-scroll-target="#exploring-the-esol-dataset">Exploring the ESOL Dataset</a>
  <ul class="collapse">
  <li><a href="#what-should-you-be-looking-for" id="toc-what-should-you-be-looking-for" class="nav-link" data-scroll-target="#what-should-you-be-looking-for">What should you be looking for?</a></li>
  </ul></li>
  <li><a href="#cleaning-the-esol-dataset" id="toc-cleaning-the-esol-dataset" class="nav-link" data-scroll-target="#cleaning-the-esol-dataset">Cleaning the ESOL Dataset</a>
  <ul class="collapse">
  <li><a href="#understanding-each-cleaning-step" id="toc-understanding-each-cleaning-step" class="nav-link" data-scroll-target="#understanding-each-cleaning-step">Understanding Each Cleaning Step</a></li>
  <li><a href="#final-result" id="toc-final-result" class="nav-link" data-scroll-target="#final-result">Final result</a></li>
  </ul></li>
  <li><a href="#comparing-the-messy-and-clean-esol-data" id="toc-comparing-the-messy-and-clean-esol-data" class="nav-link" data-scroll-target="#comparing-the-messy-and-clean-esol-data">Comparing the Messy and Clean ESOL Data</a>
  <ul class="collapse">
  <li><a href="#compare-dimensions" id="toc-compare-dimensions" class="nav-link" data-scroll-target="#compare-dimensions">1. Compare Dimensions</a></li>
  <li><a href="#compare-summaries" id="toc-compare-summaries" class="nav-link" data-scroll-target="#compare-summaries">2. Compare Summaries</a></li>
  <li><a href="#compare-unique-compounds" id="toc-compare-unique-compounds" class="nav-link" data-scroll-target="#compare-unique-compounds">3. Compare Unique Compounds</a></li>
  <li><a href="#spot-formatting-fixes" id="toc-spot-formatting-fixes" class="nav-link" data-scroll-target="#spot-formatting-fixes">Spot Formatting Fixes</a></li>
  <li><a href="#what-should-you-notice" id="toc-what-should-you-notice" class="nav-link" data-scroll-target="#what-should-you-notice">What Should You Notice?</a></li>
  </ul></li>
  <li><a href="#combining-datasets-using-a-shared-column" id="toc-combining-datasets-using-a-shared-column" class="nav-link" data-scroll-target="#combining-datasets-using-a-shared-column">Combining Datasets Using a Shared Column</a>
  <ul class="collapse">
  <li><a href="#what-is-smiles" id="toc-what-is-smiles" class="nav-link" data-scroll-target="#what-is-smiles">What is SMILES?</a></li>
  <li><a href="#joining-two-datasets-in-r" id="toc-joining-two-datasets-in-r" class="nav-link" data-scroll-target="#joining-two-datasets-in-r">Joining Two Datasets in R</a></li>
  <li><a href="#why-might-some-rows-not-match" id="toc-why-might-some-rows-not-match" class="nav-link" data-scroll-target="#why-might-some-rows-not-match">Why might some rows not match?</a></li>
  <li><a href="#exploring-your-joined-data-combined_data" id="toc-exploring-your-joined-data-combined_data" class="nav-link" data-scroll-target="#exploring-your-joined-data-combined_data">Exploring Your Joined Data: <code>combined_data</code></a></li>
  <li><a href="#well-done-youve-completed-workshop-2" id="toc-well-done-youve-completed-workshop-2" class="nav-link" data-scroll-target="#well-done-youve-completed-workshop-2">Well Done – You’ve Completed Workshop 2!</a></li>
  <li><a href="#what-should-you-take-away-from-this-tutorial" id="toc-what-should-you-take-away-from-this-tutorial" class="nav-link" data-scroll-target="#what-should-you-take-away-from-this-tutorial">What should you take away from this tutorial?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Workshop 2</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell" data-edit="false">
<pre class="{webr}"><code>#| edit: false
#| output: false
webr::install("gradethis", quiet = TRUE)
library(gradethis)
options(webr.exercise.checker = function(
  label, user_code, solution_code, check_code, envir_result, evaluate_result,
  envir_prep, last_value, engine, stage, ...
) {
  if (is.null(check_code)) {
    # No grading code, so just skip grading
    invisible(NULL)
  } else if (is.null(label)) {
    list(
      correct = FALSE,
      type = "warning",
      message = "All exercises must have a label."
    )
  } else if (is.null(solution_code)) {
    list(
      correct = FALSE,
      type = "warning",
      message = htmltools::tags$div(
        htmltools::tags$p("A problem occurred grading this exercise."),
        htmltools::tags$p(
          "No solution code was found. Note that grading exercises using the ",
          htmltools::tags$code("gradethis"),
          "package requires a model solution to be included in the document."
        )
      )
    )
  } else {
    gradethis::gradethis_exercise_checker(
      label = label, solution_code = solution_code, user_code = user_code,
      check_code = check_code, envir_result = envir_result,
      evaluate_result = evaluate_result, envir_prep = envir_prep,
      last_value = last_value, stage = stage, engine = engine)
  }
})</code></pre>
</div>
<section id="welcome-to-workshop-2-cleaning-and-wrangling-your-chemistry-data" class="level2">
<h2 class="anchored" data-anchor-id="welcome-to-workshop-2-cleaning-and-wrangling-your-chemistry-data">Welcome to Workshop 2: Cleaning and Wrangling Your Chemistry Data</h2>
<p>In this workshop, you will learn how to:</p>
<ul>
<li>Load a chemistry dataset into R</li>
<li>Inspect the data to identify common issues</li>
<li>Prepare for cleaning and wrangling tasks</li>
</ul>
<section id="working-with-r-studio" class="level3">
<h3 class="anchored" data-anchor-id="working-with-r-studio">Working with R Studio</h3>
<p>Please load up R Studio, and once you’ve tested each the run code chunks in this browser version, try copying them over to R Studio and running them in that environment - I recommend that you do this as you go through! It’s very important that you get used to working in R Studio - so please do practice.</p>
</section>
<section id="saving-work" class="level3">
<h3 class="anchored" data-anchor-id="saving-work">Saving work</h3>
<p>For the browser version (in Edge), you can click on the three dots in the top right hand corner, then select ‘print’ and then ‘print to pdf’.</p>
</section>
<section id="datasets-used-in-this-worksheet" class="level3">
<h3 class="anchored" data-anchor-id="datasets-used-in-this-worksheet">Datasets used in this worksheet</h3>
<p>We will be working with two datasets:</p>
<ol type="1">
<li><p>The <strong>ESOL dataset</strong>, which contains aqueous solubility data for chemical compounds. This dataset has some intentional data issues for you to spot and fix.</p></li>
<li><p>The <strong>Lipophilicity</strong> dataset, which contains experimental logD values for small molecules, where the term <em>lipophilicity</em> represents a measure of how well a substance dissolves in fats, oils and lipids vs water!</p></li>
</ol>
</section>
<section id="how-to-use-code-chunks-in-this-worksheet" class="level3">
<h3 class="anchored" data-anchor-id="how-to-use-code-chunks-in-this-worksheet">How to use Code Chunks in this Worksheet?</h3>
<p>In this tutorial, you’ll see two types of code chunks (I’m calling them ‘type 1’ and ‘type 2’ just for clarity for you, but in reality, they’re very similar:</p>
<ul>
<li><p><strong>Run Code type 1 chunks</strong>: These are for trying things out — just click <em>Run Code</em> to see what happens!</p></li>
<li><p><strong>Run Code type 2 chunks</strong>: These ask you to complete a task. Once you’re happy with your answer, click <em>Run Code</em> to check your work… you’ll get feedback right away.</p></li>
</ul>
<p>Some Run Code type 2 exercises also come with <strong>Hint</strong> buttons (and possibly even a <strong>Show Solution</strong> button)to help you if you get stuck. Give it a try, there’s no penalty for exploring or making mistakes!</p>
<section id="example-1-run-code-type-1-chunk" class="level4">
<h4 class="anchored" data-anchor-id="example-1-run-code-type-1-chunk">Example 1: “Run Code” type 1 Chunk</h4>
<p>This is a <strong>Run Code</strong> chunk: there’s nothing to submit, you’re just playing with code!</p>
<p>Try running the code below to make R say hello:</p>
<div class="cell">
<pre class="{webr}"><code># Make R say hello!
print("Hello from R!")</code></pre>
</div>
<hr>
</section>
<section id="example-2-run-code-chunk-type-2-for-graded-feedback" class="level4">
<h4 class="anchored" data-anchor-id="example-2-run-code-chunk-type-2-for-graded-feedback">Example 2: “Run Code” Chunk type 2 (for graded feedback)</h4>
<p>This is also a <strong>Run Code</strong> chunk. But… this time, after you’ve typed your answer and clicked <strong>Run Code</strong>, you’ll get graded feedback that will tell you if you’re correct and may even give you a hint about how to improve your answer!</p>
<p>Talking of hints… you’ll see that, in this example, that there is also a button called <code>Show Hint</code>. Try clicking it and see what happens!</p>
<p>In this example, we’ll use <code>nchar()</code> to count the number of letters in the word <code>"banana"</code> and assign it to a variable called <code>banana_length</code>. Simply fill in the blank!</p>
<div class="cell" data-caption="Fill in the blank" data-exercise="banana-example">
<pre class="{webr}"><code>#| caption: Fill in the blank
#| exercise: banana-example
 banana_length &lt;- nchar("____")</code></pre>
</div>
<div class="hint" data-exercise="banana-example">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hint 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Remember to keep the name of the word to be counted in inverted commas ” “.</p>
</div>
</div>
</div>
</div>
<div class="proof solution" data-exercise="banana-example">
<p><span class="proof-title"><em>Solution</em> (Fully worked solution). </span></p>
<div class="cell" data-exercise="banana-example" data-solution="true">
<pre class="{webr}"><code>#| exercise: banana-example
#| solution: true
banana_length &lt;- nchar("banana")</code></pre>
</div>
</div>
<div class="cell" data-exercise="banana-example" data-check="true">
<pre class="{webr}"><code>#| exercise: banana-example
#| check: true
gradethis::grade_this_code()</code></pre>
</div>
</section>
</section>
<section id="data-source-acknowledgement" class="level3">
<h3 class="anchored" data-anchor-id="data-source-acknowledgement">Data Source Acknowledgement</h3>
<p>The ESOL and Lipophilicity datasets used in this workshop are from <a href="https://moleculenet.org/">MoleculeNet</a>,<br>
a benchmarking platform for molecular machine learning datasets.<br>
Please refer to Wu et al., <em>MoleculeNet: a benchmark for molecular machine learning</em>, Chemical Science, 2018, 9, 513-530 for details.</p>
<p>We thank the authors and contributors for making these datasets publicly available.</p>
</section>
</section>
<section id="understanding-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="understanding-r-packages">Understanding R packages</h2>
<p>If you remember from last week, packages in R are like plug-ins or apps for R. They add extra tools and features that don’t come built-in, so you can do more things easily, such as reading data files or cleaning your data.</p>
<p>In this case, as we’ll be importing and manipulating datasets today, we’ll use the <code>readr</code> package to import .csv files and <code>dplyr</code> for data manipulation.</p>
<section id="how-package-installation-works" class="level3">
<h3 class="anchored" data-anchor-id="how-package-installation-works">How package installation works</h3>
<p>When working in R (e.g.&nbsp;R Studio), you will need to install packages using the <code>install.packages()</code> command. For example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"readr"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Please note that for the browser version these have already been installed automatically for you but you will have to install them in R Studio - simply copy and paste the code in!</p>
<p>In R Studio, you can find out which packages have been installed by looking at the ‘Packages’ tab in the bottom right pane to spot them!</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Important notes about installing packages:</em><br>
Package names must be in quotation marks: <code>install.packages("dplyr")</code>. Without quotes, as shown in the example here, you’ll get an error: <code>install.packages(dplyr)</code>.<br>
You only need to install a package once on your computer (assuming that this is not using the KU environment, which wipes this!). The setup script already checked for you and only installed packages you didn’t already have.</p>
</div>
</div>
</section>
<section id="exercise-loading-packages" class="level3">
<h3 class="anchored" data-anchor-id="exercise-loading-packages">Exercise: Loading packages</h3>
<p>After packages are installed, you need to <strong>load</strong> them to use their functions. This is done with the <code>library()</code> function. Slightly differently from <code>install.packages</code>, you don’t have to have inverted commas around the name though (it doesn’t matter whether you have them or not). For example, if you wanted to load the ‘beepr’ package (having installed it first!), you’d type:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bleepr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>In case, by the way, you’re wondering what the <code>bleepr</code> package is, it’s as the name suggests… a package that enables you to get an audible alert whenever your code finishes.</p>
<p>Anyway, back to the task at hand! Think of the difference between using <code>install.packages</code> and <code>library</code> like downloading an app from an app Store vs opening an app. You only need to download an app once on your device (or in your R environment). However, even if the app is installed, you can’t use it until you open it. And… every time you restart your computer or your phone (or R session), you’ll need to open the app again.</p>
<p>Try loading both <code>readr</code> and <code>dplyr</code> in the box below:</p>
<div class="cell" data-exercise="load-packages-exercise">
<pre class="{webr}"><code>#| exercise: load-packages-exercise
</code></pre>
</div>
<div class="hint" data-exercise="load-packages-exercise">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hint 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Use the <code>library()</code> function to load packages! Package names do NOT need quotes in library. For the package <code>readr</code> this would look like:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Now you do the same for dplyr!</p>
</div>
</div>
</div>
</div>
<div class="hint" data-exercise="load-packages-exercise">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hint 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Use the library() function to load packages. Remember, package names do NOT need quotes in library().</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="proof solution" data-exercise="load-packages-exercise">
<p><span class="proof-title"><em>Solution</em> (Fully worked solution). </span></p>
<div class="cell" data-exercise="load-packages-exercise" data-solution="true">
<pre class="{webr}"><code>#| exercise: load-packages-exercise
#| solution: true
library(readr)
library(dplyr)</code></pre>
</div>
</div>
<div class="cell" data-exercise="load-packages-exercise" data-check="true">
<pre class="{webr}"><code>#| exercise: load-packages-exercise
#| check: true
gradethis::grade_this_code()</code></pre>
</div>
<div class="cell">
<pre class="{webr}"><code>#| include: false
library(readr)
library(dplyr)</code></pre>
</div>
<p><strong>Note:</strong> Again, just to reiterate, unlike installation (i.e.&nbsp;using <code>install.packages</code>), you need to load packages with <code>library()</code> <em>every</em> time you start a new R session!</p>
</section>
<section id="why-cleaning-your-data-matters-in-chemistry" class="level3">
<h3 class="anchored" data-anchor-id="why-cleaning-your-data-matters-in-chemistry">Why Cleaning Your Data Matters in Chemistry</h3>
<p>In pharmaceutical and chemical research, your data is only as good as its <strong>quality</strong>.</p>
<p>Whether you’re working with:</p>
<ul>
<li><em>Experimental data</em> (e.g.&nbsp;solubility measurements from the lab), or<br>
</li>
<li><em>Literature-mined data</em> (e.g.&nbsp;scraped or compiled from journal articles or public databases),</li>
</ul>
<p>…there are often <strong>errors, inconsistencies, or missing values</strong> that need fixing before any meaningful analysis.</p>
</section>
<section id="common-data-problems-in-chemistry" class="level3">
<h3 class="anchored" data-anchor-id="common-data-problems-in-chemistry">Common data problems in chemistry:</h3>
<ul>
<li><strong>Missing or incomplete values</strong> (e.g.&nbsp;no logS reported for some compounds)<br>
</li>
<li><strong>Units or scales that don’t match</strong> (e.g.&nbsp;logP vs.&nbsp;logD, or µg/mL vs.&nbsp;mol/L)<br>
</li>
<li><strong>Inconsistent naming</strong> of chemical compounds<br>
</li>
<li><strong>Duplicate entries</strong> in literature-mined datasets<br>
</li>
<li><strong>Implausible values</strong> (e.g.&nbsp;negative molecular weights!)</li>
</ul>
<blockquote class="blockquote">
<p><strong>Why it matters:</strong><br>
If we skip the cleaning step, we risk drawing wrong conclusions — or feeding errors into models or visualisations. It’s like trying to bake a cake with the wrong ingredients.</p>
</blockquote>
<hr>
</section>
</section>
<section id="importing-the-esol-dataset" class="level2">
<h2 class="anchored" data-anchor-id="importing-the-esol-dataset">Importing the ESOL Dataset</h2>
<p>Now let’s load a sample dataset: <strong>ESOL</strong>, a solubility dataset containing chemical compounds with their predicted aqueous solubility (<code>logS</code>), molecular weight (<code>MolWt</code>), and other properties.</p>
<blockquote class="blockquote">
<p>We’ve introduced a few intentional issues to simulate what real chemical datasets often look like!</p>
</blockquote>
<p>You can access the file <code>esol_messy.csv</code> from the data folder associated with this tutorial.</p>
<hr>
<section id="exercise-import-the-esol-dataset" class="level3">
<h3 class="anchored" data-anchor-id="exercise-import-the-esol-dataset">Exercise: Import the ESOL dataset</h3>
<p>You’re going to import the file <code>esol_messy.csv</code> into R using <code>read_csv()</code> from the <code>readr</code> package.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Important reminder:</em><br>
When you use <code>read_csv()</code>, it <strong>reads the data</strong> — but it doesn’t automatically store it anywhere.<br>
You need to <strong>assign</strong> the result to a data frame (just like we did last week) using the <code>&lt;-</code> operator.</p>
</div>
</div>
<p>For this exercise, please assign your data to an object called <code>esol_data</code>. The file itself is called <code>esol_messy.csv</code> and it’s in a folder called <code>data</code> on the browser. You will therefore have to group these two together as: <code>data/esol_messy.csv</code>.</p>
<p>Okay… your go! Please have a go at importing your data using <code>read_csv()</code>:</p>
<div class="cell" data-exercise="import-esol-exercise" data-min-lines="2">
<pre class="{webr}"><code>#| exercise: import-esol-exercise
#| min-lines: 2
</code></pre>
</div>
<p>Hopefully that’s worked!! Don’t worry if your code didn’t quite work though… I’ve made sure the dataset is available behind the scenes so you can still follow along with the next steps. But… just in case you had any issues, and if you want to keep on, feel free to go back and try again!</p>
<p>When doing this in R Studio, you will need to download the files from Canvas, save them and ensure that you have included its full address, rather than just ‘data/’.</p>
<p><em>Tip</em>: You can use the <code>print()</code> command with the name of your variable (here: esol_data) e.g.&nbsp;<code>print(VARIABLE)</code> to display the entire dataset (or as much of it as fits in your window). This can help you get a quick overview of the data contents. Why don’t you try that in the box below:</p>
<div class="cell" data-setup="true" data-exercise="[&quot;print-esol-data&quot;,&quot;explore-esol-data&quot;,&quot;clean-esol-guided&quot;]">
<pre class="{webr}"><code>#| setup: true
#| exercise:
#|  - print-esol-data
#|  - explore-esol-data
#|  - clean-esol-guided

esol_data &lt;- read_csv("data/esol_messy.csv", show_col_types = FALSE)</code></pre>
</div>
<div class="cell" data-exercise="print-esol-data">
<pre class="{webr}"><code>#| exercise: print-esol-data
</code></pre>
</div>
<div class="hint" data-exercise="print-esol-data">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hint 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Use the print() function with the name of the function (here: esol_data)</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(esol_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="proof solution" data-exercise="print-esol-data">
<p><span class="proof-title"><em>Solution</em> (Fully worked solution). </span></p>
<div class="cell" data-exercise="print-esol-data" data-solution="true">
<pre class="{webr}"><code>#| exercise: print-esol-data
#| solution: true
print(esol_data)</code></pre>
</div>
</div>
<div class="cell" data-exercise="print-esol-data" data-check="true">
<pre class="{webr}"><code>#| exercise: print-esol-data
#| check: true
gradethis::grade_this_code()</code></pre>
</div>
<p>Take particular note of the names of the columns (you’ll need this later).</p>
<p>FYI, you can add a couple of options to the print command: <code>n =</code> and <code>width =</code> e.g.&nbsp;<code>print(VARIABLE, n = 25, width = Inf)</code> to change the number of columns and rows shown</p>
</section>
</section>
<section id="exploring-the-esol-dataset" class="level2">
<h2 class="anchored" data-anchor-id="exploring-the-esol-dataset">Exploring the ESOL Dataset</h2>
<p>Now that you’ve imported the <strong>ESOL dataset</strong>, let’s take a look at what we’re dealing with.</p>
<p>This data was collected from a combination of experimental and literature-mined sources. While useful, it’s also a bit… messy.</p>
<p>Let’s inspect it to see what needs cleaning!</p>
<p>Three useful functions to help you explore any data frame are:</p>
<ul>
<li><code>head(data)</code> – shows you the <strong>first few rows</strong> of your data. Great for a quick peek!</li>
<li><code>str(data)</code> – shows you the <strong>structure</strong> of the dataset: column names, data types, and examples.</li>
<li><code>summary(data)</code> – gives you <strong>summary statistics</strong> for each column: min, max, median, and so on.</li>
</ul>
<section id="try-this-in-the-code-box-below" class="level4">
<h4 class="anchored" data-anchor-id="try-this-in-the-code-box-below">Try this in the code box below:</h4>
<p>Use the following functions to explore your dataset. The # symbol can be useful for you here… in code, it means ‘comment’ and tells R not to read either itself or anything after it on the same time. When coding, it’s important to comment throughout so that both you and anyone else can understand your code.</p>
<p>So… try using the <code>#</code> symbol to block out any two of the functions at any one time, then select ‘run code’ to see what the other function does - and then repeat the loop for the other two functions.</p>
<div class="cell" data-exercise="explore-esol-data">
<pre class="{webr}"><code>#| exercise: explore-esol-data

head(esol_data)     # Shows the first few rows
str(esol_data)      # Shows structure and data types
summary(esol_data)  # Gives quick summaries for each column
</code></pre>
</div>
</section>
<section id="what-should-you-be-looking-for" class="level3">
<h3 class="anchored" data-anchor-id="what-should-you-be-looking-for">What should you be looking for?</h3>
<p>As you explore the data, keep an eye out for:</p>
<ul>
<li><strong>Missing values</strong> — are there any <code>NA</code>s?</li>
<li><strong>Weird formatting</strong> — for example, compound names in ALL CAPS or with trailing spaces</li>
<li><strong>Outliers</strong> — very large or small values that don’t seem realistic</li>
<li><strong>Duplicates</strong> — are there repeated compounds?</li>
</ul>
<p>These are all common issues in real-world datasets, and spotting them is the first step toward fixing them!</p>
</section>
</section>
<section id="cleaning-the-esol-dataset" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-the-esol-dataset">Cleaning the ESOL Dataset</h2>
<p>Now that you’ve had a chance to explore the dataset, let’s start cleaning it!</p>
<p>We’ll do this step by step using <code>dplyr</code> functions (you should have loaded this into the memory earlier using <code>library(dplyr)</code>). Your job is to fill in the blanks.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Tip</em>: Use <code>filter()</code> to remove rows, <code>mutate()</code> to create or modify columns, and <code>distinct()</code> to remove duplicates.</p>
</div>
</div>
<p>Try the code below. Fill in the blanks with the appropriate column heading name (you’ll need to remove the “____” bits first (just remember <em>this is important</em> that if your heading has spaces in, you’ll need to put the whole heading name between <code>backticks</code> i.e.&nbsp;`. The<code>backtick</code> ` button is often found just above the ‘tab’ button)!</p>
<div class="cell" data-exercise="clean-esol-guided">
<pre class="{webr}"><code>#| exercise: clean-esol-guided

# Start with the original esol_data
clean_esol &lt;- esol_data %&gt;%
  # 1. Remove rows where logS is missing
  filter(!is.na("____")) %&gt;%
  # 2. Standardise the compound names
  mutate(compound = tolower(trimws("____"))) %&gt;%
  # 3. Remove duplicate rows
  distinct()
</code></pre>
</div>
<div class="hint" data-exercise="clean-esol-guided">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hint 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Remember, the names of the headings are: The compound names: Compound ID The logS values: ESOL predicted log solubility in mols per litre</p>
</div>
</div>
</div>
</div>
<div class="proof solution" data-exercise="clean-esol-guided">
<p><span class="proof-title"><em>Solution</em> (Fully worked solution). </span></p>
<div class="cell" data-exercise="clean-esol-guided" data-solution="true">
<pre class="{webr}"><code>#| exercise: clean-esol-guided
#| solution: true

# Start with the original esol_data
clean_esol &lt;- esol_data %&gt;%
  # 1. Remove rows where logS is missing
  filter(!is.na(`ESOL predicted log solubility in mols per litre`)) %&gt;%
  # 2. Standardise the compound names
  mutate(compound = tolower(trimws(`Compound ID`))) %&gt;%
  # 3. Remove duplicate rows
  distinct()</code></pre>
</div>
</div>
<div class="cell" data-exercise="clean-esol-guided" data-check="true">
<pre class="{webr}"><code>#| exercise: clean-esol-guided
#| check: true
gradethis::grade_this_code()</code></pre>
</div>
<section id="understanding-each-cleaning-step" class="level3">
<h3 class="anchored" data-anchor-id="understanding-each-cleaning-step">Understanding Each Cleaning Step</h3>
<p>Let’s take a moment to understand exactly what each line of the cleaning pipeline is doing…</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>clean_esol <span class="ot">&lt;-</span> esol_data <span class="sc">%&gt;%</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>We’re building a data cleaning pipeline using the pipe operator (%&gt;%). This means each line takes the result from the previous step and passes it forward to the next one.</p>
<p>Let’s break it down step-by-step:</p>
<section id="a-filteris.na" class="level5">
<h5 class="anchored" data-anchor-id="a-filteris.na">(a) <code>filter(!is.na("  "))</code></h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">ESOL predicted log solubility in mols per litre</span><span class="st">`</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>filter()</code> is used to keep only certain rows of the data.</li>
<li><code>is.na(</code>ESOL predicted log solubility in mols per litre<code>)</code> checks for missing values (NAs) in the “ESOL predicted log solubility in mols per litre” column.</li>
<li><code>!is.na(</code>ESOL predicted log solubility in mols per litre<code>)</code> means “not missing”, so this line keeps only rows where there is a value for logS.</li>
</ul>
</section>
<section id="b-mutatecompound-tolowertrimws" class="level5">
<h5 class="anchored" data-anchor-id="b-mutatecompound-tolowertrimws">(b) <code>mutate(compound = tolower(trimws("   ")))</code></h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">compound =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(<span class="st">`</span><span class="at">Compound ID</span><span class="st">`</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>mutate()</code> is used to modify or create a new column.</li>
<li>Inside it, we’re creating a new compound column.</li>
<li><code>trimws()</code> removes leading and trailing whitespace from the compound names.</li>
<li><code>tolower()</code> converts all characters to lowercase.</li>
</ul>
<p>Together, this helps standardise the formatting of compound names (e.g.&nbsp;fixing ” ACETAMINOPHEN ” to “acetaminophen”).</p>
</section>
<section id="c-distinct" class="level5">
<h5 class="anchored" data-anchor-id="c-distinct">(c) <code>distinct()</code></h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>The command <code>distinct()</code> removes duplicate rows from the data frame.</li>
<li>Sometimes in real datasets, the same compound appears more than once — this helps clean that up.</li>
<li>If you want to remove duplicates only based on certain columns, you can do: <code>distinct(compound, .keep_all = TRUE)</code>.</li>
</ul>
</section>
</section>
<section id="final-result" class="level3">
<h3 class="anchored" data-anchor-id="final-result">Final result</h3>
<p>The cleaned dataset is now stored in a new object called clean_esol. This is what you’ll use going forward in your analysis — it’s more reliable and ready for real work!</p>
</section>
</section>
<section id="comparing-the-messy-and-clean-esol-data" class="level2">
<h2 class="anchored" data-anchor-id="comparing-the-messy-and-clean-esol-data">Comparing the Messy and Clean ESOL Data</h2>
<p>Now that you’ve cleaned your dataset and created <code>esol_clean</code>, let’s compare it to the original messy version (<code>esol_messy</code>) to see what’s changed.</p>
<div class="cell" data-setup="true" data-exercise="[&quot;compare_dimensions&quot;,&quot;compare-dimensions-summary&quot;,&quot;compare-unique-compounds&quot;,&quot;spot-format-fixes&quot;,&quot;combine-lipo-esol&quot;,&quot;explore-comb-data&quot;]">
<pre class="{webr}"><code>#| setup: true
#| exercise:
#|  - compare_dimensions
#|  - compare-dimensions-summary
#|  - compare-unique-compounds
#|  - spot-format-fixes
#|  - combine-lipo-esol
#|  - explore-comb-data

esol_data &lt;- readr::read_csv("data/esol_messy.csv", show_col_types = FALSE)
clean_esol &lt;- esol_data %&gt;%
  # 1. Remove rows where logS is missing
  filter(!is.na(`ESOL predicted log solubility in mols per litre`)) %&gt;%
  # 2. Standardise the compound names
  mutate(compound = tolower(trimws(`Compound ID`))) %&gt;%
  # 3. Remove duplicate rows
  distinct()

lipo_data &lt;- read_csv("data/Lipophilicity.csv", show_col_types = FALSE)
clean_lipo &lt;- lipo_data %&gt;%
  # 1. Remove rows where logP is missing
  filter(!is.na(exp)) %&gt;%
  # 2. Remove duplicate rows
  distinct()
combined_data &lt;- left_join(clean_esol, clean_lipo, by = "smiles")</code></pre>
</div>
<section id="compare-dimensions" class="level3">
<h3 class="anchored" data-anchor-id="compare-dimensions">1. Compare Dimensions</h3>
<p>Use <code>nrow()</code> and <code>ncol()</code> to check how many rows and columns each version (i.e.&nbsp;<code>esol_data</code> and <code>clean_esol</code>) has. Run the code below to see what happens…</p>
<div class="cell" data-exercise="compare_dimensions">
<pre class="{webr}"><code>#| exercise: compare_dimensions
nrow(esol_data)
nrow(clean_esol)

ncol(esol_data)
ncol(clean_esol)</code></pre>
</div>
</section>
<section id="compare-summaries" class="level3">
<h3 class="anchored" data-anchor-id="compare-summaries">2. Compare Summaries</h3>
<p>Use <code>summary()</code> to compare key columns (like logS (i.e.&nbsp;“ESOL predicted log solubility in mols per litre”) or MolWt i.e.&nbsp;“Molecular Weight”). Try running the code below and then the column for another.</p>
<div class="cell" data-exercise="compare-dimensions-summary">
<pre class="{webr}"><code>#| exercise: compare-dimensions-summary

summary(esol_data$`ESOL predicted log solubility in mols per litre`)
summary(clean_esol$`ESOL predicted log solubility in mols per litre`)</code></pre>
</div>
</section>
<section id="compare-unique-compounds" class="level3">
<h3 class="anchored" data-anchor-id="compare-unique-compounds">3. Compare Unique Compounds</h3>
<p>Let’s see how many unique compounds are in each dataset. Remember, earlier you created a new column called ‘compound’ when you cleaned the ‘Compound ID’ column.</p>
<div class="cell" data-exercise="compare-unique-compounds">
<pre class="{webr}"><code>#| exercise: compare-unique-compounds

length(unique(esol_data$`Compound ID`))
length(unique(clean_esol$compound))</code></pre>
</div>
</section>
<section id="spot-formatting-fixes" class="level3">
<h3 class="anchored" data-anchor-id="spot-formatting-fixes">Spot Formatting Fixes</h3>
<p>Try printing a few rows to visually inspect any fixes to formatting.</p>
<div class="cell" data-exercise="spot-format-fixes">
<pre class="{webr}"><code>#| exercise: spot-format-fixes 

head(esol_data$`Compound ID`, 5)
head(clean_esol$compound, 5)</code></pre>
</div>
<p>You should see that names in the cleaned data are now lowercase and free of trailing spaces.</p>
</section>
<section id="what-should-you-notice" class="level3">
<h3 class="anchored" data-anchor-id="what-should-you-notice">What Should You Notice?</h3>
<ul>
<li>Fewer rows? Good! You cleaned out invalid entries or duplicates.</li>
<li>Improved summaries? Excellent — weird or missing values are likely gone.</li>
<li>Tidier names? Formatting is more consistent for analysis or merging.</li>
</ul>
<p>You’re now ready to move on to combine this cleaned data with another!</p>
</section>
</section>
<section id="combining-datasets-using-a-shared-column" class="level2">
<h2 class="anchored" data-anchor-id="combining-datasets-using-a-shared-column">Combining Datasets Using a Shared Column</h2>
<p>Now that you’ve had practice cleaning the <strong>ESOL</strong> dataset, it’s time to bring in a second dataset <strong>Lipophilicity</strong> and learn how to <strong>combine datasets</strong> in R!</p>
<p>In real-world data science, it’s often helpful to combine different datasets to create a richer picture of your information. Here, we’ll match compounds between datasets using a common column: the <strong>SMILES</strong> string, which uniquely encodes the structure of each molecule.</p>
<section id="what-is-smiles" class="level3">
<h3 class="anchored" data-anchor-id="what-is-smiles">What is SMILES?</h3>
<p>SMILES stands for <strong>Simplified Molecular Input Line Entry System</strong>. It’s a compact way to represent a chemical structure using a string of text (e.g., <code>"CCO"</code> for ethanol).</p>
<p>Both the ESOL and Lipophilicity datasets contain a <code>SMILES</code> column (actually written in lowercase in the datasets), so even if the compounds are named differently elsewhere, we can match them using this column.</p>
<p>The Lipophilicity dataset has already been imported and cleaned into the browser, just to save you the trouble! However, if you’re working in R Studio, you will need to save and use <code>read_csv</code> as before to read it into a dataframe (please call it <code>clean_lipo</code>).</p>
<p>For the browser version, as I mentioned, the cleaned dataset is already in a dataframe called: <strong>clean_lipo</strong>. Remember, your cleaned ESOL dataset is also in a dataframe called: <strong>clean_esol</strong>.</p>
<hr>
</section>
<section id="joining-two-datasets-in-r" class="level3">
<h3 class="anchored" data-anchor-id="joining-two-datasets-in-r">Joining Two Datasets in R</h3>
<p>In R, we use the <code>dplyr::left_join()</code> function to combine two data frames.</p>
<p>Here’s what the syntax looks like:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(clean_esol, clean_lipo, <span class="at">by =</span> <span class="st">"smiles"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This line says:</p>
<ul>
<li>“Take the clean ESOL data (<code>clean_esol</code>)…”</li>
<li>“…and add matching rows from the clean Lipophilicity data (<code>clean_lipo</code>)…”</li>
<li>“…based on the values in the <code>SMILES</code> column.”</li>
</ul>
<p>The result is a new data frame (<code>combined_data</code>) that contains:</p>
<ul>
<li>All rows from <code>clean_esol</code></li>
<li>Any matching columns from <code>clean_lipo</code>, added alongside</li>
</ul>
</section>
<section id="why-might-some-rows-not-match" class="level3">
<h3 class="anchored" data-anchor-id="why-might-some-rows-not-match">Why might some rows not match?</h3>
<p>Remember, not every molecule in the ESOL dataset will be found in the Lipophilicity dataset, and that’s okay! The <code>left_join()</code> function keeps all of the data from the left table (<code>clean_esol</code>), and only fills in values from <code>clean_lipo</code> where it finds matching <code>SMILES</code> codes.</p>
<p>This means we might see NAs in the Lipophilicity columns for compounds that don’t have a match… that’s completely normal!</p>
<p>Try running it yourself in the blank box below:</p>
<div class="cell" data-exercise="combine-lipo-esol">
<pre class="{webr}"><code>#| exercise: combine-lipo-esol
</code></pre>
</div>
<div class="hint" data-exercise="combine-lipo-esol">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hint 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Look above!</p>
</div>
</div>
</div>
</div>
<div class="proof solution" data-exercise="combine-lipo-esol">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<div class="cell" data-exercise="combine-lipo-esol" data-solution="true">
<pre class="{webr}"><code>#| exercise: combine-lipo-esol
#| solution: true
combined_data &lt;- left_join(clean_esol, clean_lipo, by = "smiles")</code></pre>
</div>
</div>
<div class="cell" data-exercise="combine-lipo-esol" data-check="true">
<pre class="{webr}"><code>#| exercise: combine-lipo-esol
#| check: true
gradethis::grade_this_code()</code></pre>
</div>
</section>
<section id="exploring-your-joined-data-combined_data" class="level3">
<h3 class="anchored" data-anchor-id="exploring-your-joined-data-combined_data">Exploring Your Joined Data: <code>combined_data</code></h3>
<p>Now that you’ve created a new data frame called <code>combined_data</code>, let’s take a moment to explore it and see what you’re working with. Use the <code>head()</code>, <code>str()</code> and <code>summary()</code> commands that we covered earlier to do this in the box below:</p>
<div class="cell" data-exercise="explore-comb-data">
<pre class="{webr}"><code>#| exercise: explore-comb-data
</code></pre>
</div>
</section>
<section id="well-done-youve-completed-workshop-2" class="level3">
<h3 class="anchored" data-anchor-id="well-done-youve-completed-workshop-2">Well Done – You’ve Completed Workshop 2!</h3>
<p>You’ve just worked through a full data cleaning and wrangling workflow using <strong>real chemistry datasets</strong> — that’s no small feat! Here’s a quick recap of what you accomplished:</p>
<p>✅ You successfully <strong>imported messy chemical data</strong> using <code>readr::read_csv()</code><br>
✅ You used <code>dplyr</code> and <code>tidyr</code> to <strong>clean and wrangle your data</strong><br>
✅ You learned how to spot <strong>missing values, weird formatting, and duplicates</strong><br>
✅ You created new variables and standardised your data<br>
✅ You <strong>joined two datasets</strong> using a common key (<code>SMILES</code>) to create a richer dataset<br>
✅ You explored your cleaned, combined dataset like a pro!</p>
<hr>
</section>
<section id="what-should-you-take-away-from-this-tutorial" class="level3">
<h3 class="anchored" data-anchor-id="what-should-you-take-away-from-this-tutorial">What should you take away from this tutorial?</h3>
<ul>
<li>Cleaning data is a vital step in any data science project — messy data leads to misleading results.</li>
<li>Tools like <code>filter()</code>, <code>mutate()</code>, and <code>select()</code> give you full control over how your data is structured.</li>
<li>Combining datasets can open the door to deeper analysis, comparisons, and insight — especially in fields like <strong>chemoinformatics</strong>.</li>
</ul>
<p><br><br><br></p>
<blockquote class="blockquote">
<p><strong>License:</strong> This tutorial is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.</p>
</blockquote>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/gcshearman\.github\.io\/CH4004-R\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Workshop1.html" class="pagination-link" aria-label="Workshop 1">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Workshop 1</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Workshop3_introduction.html" class="pagination-link" aria-label="Introduction to Workshop 3">
        <span class="nav-page-text">Introduction to Workshop 3</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>